2025-04-06 18:30:06,929 - INFO - Args in experiment:
2025-04-06 18:30:06,930 - INFO - Namespace(a=1.0, activation='gelu', anomaly_ratio=0.25, augmentations='flip,shuffle,frequency,jitter,mask,drop', b=1.1, batch_size=32, c_out=7, chunk_size=16, d_conv=4, d_ff=256, d_layers=1, d_model=128, data='TDBRAIN', data_path='ETTh1.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, dropout=0.1, e_layers=6, embed='timeF', enc_in=33, expand=2, factor=1, features='M', freq='h', gpu=0, inverse=False, is_training=1, itr=5, label_len=48, learnab=False, learning_rate=0.0001, loss='MSE', lradj='type1', mask_rate=0.25, model='TCN', model_id='TDBRAIN-Indep_-1_25_1_1.1_nolearnab_best', moving_avg=25, n=25, n_heads=8, no_inter_attn=False, num_class=2, num_kernels=6, num_workers=0, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patch_H='2,4,8', patch_len=16, patch_len_list='2,4,8', patience=10, pred_len=0, root_path='../Medformer_train/dataset/TDBRAIN/', sampling_rate=256, seasonal_patterns='Monthly', seed=45, seq_len=256, single_channel=False, stride=8, swa=False, t=-1, target='OT', task_name='classification', top_k=5, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
2025-04-06 18:30:06,930 - INFO - >>>>>>>training : classification_TDBRAIN-Indep_-1_25_1_1.1_nolearnab_best_TCN_TDBRAIN_ftM_sl256_ll48_pl0_dm128_nh8_el6_dl1_df256_fc1_ebtimeF_dtTrue_Exp_seed45<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2025-04-06 18:30:10,685 - INFO - train_steps: 135
2025-04-06 18:30:10,687 - INFO - 
2025-04-06 18:30:10,687 - INFO - 
2025-04-06 18:30:14,426 - INFO - 	iters: 100, epoch: 1 | loss: 0.1357865
2025-04-06 18:30:14,426 - INFO - 	speed: 0.0374s/iter; left time: 501.3592s
2025-04-06 18:30:15,658 - INFO - Epoch: 1 cost time: 4.9707
2025-04-06 18:30:16,917 - INFO - Epoch: 1, Steps: 135 | Train Loss: 0.29544
Validation results --- Loss: 0.22765, Accuracy: 0.92396, Precision: 0.93238, Recall: 0.92396, F1: 0.92359, AUROC: 0.98692, AUPRC: 0.98479
Test results --- Loss: 0.32797, Accuracy: 0.84167, Precision: 0.84953, Recall: 0.84167, F1: 0.84077, AUROC: 0.94340, AUPRC: 0.94622
2025-04-06 18:30:16,918 - INFO - Metric score decreased (inf --> -0.923586).  Saving model ...
2025-04-06 18:30:16,943 - INFO - Model saved at ./checkpoints/classification/TDBRAIN-Indep_-1_25_1_1.1_nolearnab_best/TCN/classification_TDBRAIN-Indep_-1_25_1_1.1_nolearnab_best_TCN_TDBRAIN_ftM_sl256_ll48_pl0_dm128_nh8_el6_dl1_df256_fc1_ebtimeF_dtTrue_Exp_seed45//checkpoint.pth
2025-04-06 18:30:16,943 - INFO - 
2025-04-06 18:30:16,943 - INFO - 
2025-04-06 18:30:20,513 - INFO - 	iters: 100, epoch: 2 | loss: 0.0666457
2025-04-06 18:30:20,514 - INFO - 	speed: 0.0609s/iter; left time: 807.4436s
2025-04-06 18:30:21,723 - INFO - Epoch: 2 cost time: 4.7798
2025-04-06 18:30:22,956 - INFO - Epoch: 2, Steps: 135 | Train Loss: 0.08847
Validation results --- Loss: 0.11999, Accuracy: 0.96354, Precision: 0.96399, Recall: 0.96354, F1: 0.96353, AUROC: 0.99117, AUPRC: 0.99007
Test results --- Loss: 0.22562, Accuracy: 0.89792, Precision: 0.89928, Recall: 0.89792, F1: 0.89783, AUROC: 0.96985, AUPRC: 0.97088
2025-04-06 18:30:22,957 - INFO - Metric score decreased (-0.923586 --> -0.963533).  Saving model ...
2025-04-06 18:30:23,031 - INFO - Model saved at ./checkpoints/classification/TDBRAIN-Indep_-1_25_1_1.1_nolearnab_best/TCN/classification_TDBRAIN-Indep_-1_25_1_1.1_nolearnab_best_TCN_TDBRAIN_ftM_sl256_ll48_pl0_dm128_nh8_el6_dl1_df256_fc1_ebtimeF_dtTrue_Exp_seed45//checkpoint.pth
2025-04-06 18:30:23,032 - INFO - 
2025-04-06 18:30:23,032 - INFO - 
2025-04-06 18:30:26,682 - INFO - 	iters: 100, epoch: 3 | loss: 0.0076008
2025-04-06 18:30:26,683 - INFO - 	speed: 0.0617s/iter; left time: 810.1500s
2025-04-06 18:30:28,011 - INFO - Epoch: 3 cost time: 4.9794
2025-04-06 18:30:29,194 - INFO - Epoch: 3, Steps: 135 | Train Loss: 0.02497
Validation results --- Loss: 0.13960, Accuracy: 0.96458, Precision: 0.96693, Recall: 0.96458, F1: 0.96454, AUROC: 0.99381, AUPRC: 0.99286
Test results --- Loss: 0.15817, Accuracy: 0.93333, Precision: 0.93370, Recall: 0.93333, F1: 0.93332, AUROC: 0.98666, AUPRC: 0.98721
2025-04-06 18:30:29,195 - INFO - Metric score decreased (-0.963533 --> -0.964539).  Saving model ...
2025-04-06 18:30:29,227 - INFO - Model saved at ./checkpoints/classification/TDBRAIN-Indep_-1_25_1_1.1_nolearnab_best/TCN/classification_TDBRAIN-Indep_-1_25_1_1.1_nolearnab_best_TCN_TDBRAIN_ftM_sl256_ll48_pl0_dm128_nh8_el6_dl1_df256_fc1_ebtimeF_dtTrue_Exp_seed45//checkpoint.pth
2025-04-06 18:30:29,227 - INFO - 
2025-04-06 18:30:29,227 - INFO - 
2025-04-06 18:30:32,649 - INFO - 	iters: 100, epoch: 4 | loss: 0.0009139
2025-04-06 18:30:32,649 - INFO - 	speed: 0.0597s/iter; left time: 775.2623s
2025-04-06 18:30:33,717 - INFO - Epoch: 4 cost time: 4.4897
2025-04-06 18:30:34,366 - INFO - Epoch: 4, Steps: 135 | Train Loss: 0.00654
Validation results --- Loss: 0.29559, Accuracy: 0.90625, Precision: 0.92105, Recall: 0.90625, F1: 0.90542, AUROC: 0.99478, AUPRC: 0.99445
Test results --- Loss: 0.28696, Accuracy: 0.89583, Precision: 0.91305, Recall: 0.89583, F1: 0.89474, AUROC: 0.99157, AUPRC: 0.99187
2025-04-06 18:30:34,367 - INFO - EarlyStopping counter: 1 out of 10
2025-04-06 18:30:34,367 - INFO - 
2025-04-06 18:30:34,367 - INFO - 
2025-04-06 18:30:37,186 - INFO - 	iters: 100, epoch: 5 | loss: 0.0016576
2025-04-06 18:30:37,186 - INFO - 	speed: 0.0454s/iter; left time: 583.5075s
2025-04-06 18:30:38,205 - INFO - Epoch: 5 cost time: 3.8381
2025-04-06 18:30:39,085 - INFO - Epoch: 5, Steps: 135 | Train Loss: 0.00257
Validation results --- Loss: 0.14682, Accuracy: 0.96250, Precision: 0.96483, Recall: 0.96250, F1: 0.96245, AUROC: 0.99495, AUPRC: 0.99380
Test results --- Loss: 0.13151, Accuracy: 0.94479, Precision: 0.94600, Recall: 0.94479, F1: 0.94475, AUROC: 0.99278, AUPRC: 0.99303
2025-04-06 18:30:39,085 - INFO - EarlyStopping counter: 2 out of 10
2025-04-06 18:30:39,085 - INFO - 
2025-04-06 18:30:39,085 - INFO - 
2025-04-06 18:30:41,971 - INFO - 	iters: 100, epoch: 6 | loss: 0.0003322
2025-04-06 18:30:41,971 - INFO - 	speed: 0.0478s/iter; left time: 608.9387s
2025-04-06 18:30:43,007 - INFO - Epoch: 6 cost time: 3.9220
2025-04-06 18:30:43,903 - INFO - Epoch: 6, Steps: 135 | Train Loss: 0.00375
Validation results --- Loss: 0.13947, Accuracy: 0.96042, Precision: 0.96274, Recall: 0.96042, F1: 0.96037, AUROC: 0.99539, AUPRC: 0.99406
Test results --- Loss: 0.13667, Accuracy: 0.95000, Precision: 0.95176, Recall: 0.95000, F1: 0.94995, AUROC: 0.99380, AUPRC: 0.99400
2025-04-06 18:30:43,903 - INFO - EarlyStopping counter: 3 out of 10
2025-04-06 18:30:43,903 - INFO - 
2025-04-06 18:30:43,903 - INFO - 
2025-04-06 18:30:46,822 - INFO - 	iters: 100, epoch: 7 | loss: 0.0003841
2025-04-06 18:30:46,822 - INFO - 	speed: 0.0485s/iter; left time: 610.7093s
2025-04-06 18:30:47,940 - INFO - Epoch: 7 cost time: 4.0366
2025-04-06 18:30:48,727 - INFO - Epoch: 7, Steps: 135 | Train Loss: 0.00044
Validation results --- Loss: 0.21095, Accuracy: 0.93646, Precision: 0.94362, Recall: 0.93646, F1: 0.93620, AUROC: 0.99543, AUPRC: 0.99473
Test results --- Loss: 0.18918, Accuracy: 0.93646, Precision: 0.94185, Recall: 0.93646, F1: 0.93626, AUROC: 0.99480, AUPRC: 0.99495
2025-04-06 18:30:48,728 - INFO - EarlyStopping counter: 4 out of 10
2025-04-06 18:30:48,728 - INFO - 
2025-04-06 18:30:48,728 - INFO - 
2025-04-06 18:30:51,957 - INFO - 	iters: 100, epoch: 8 | loss: 0.0001222
2025-04-06 18:30:51,957 - INFO - 	speed: 0.0514s/iter; left time: 639.6469s
2025-04-06 18:30:53,075 - INFO - Epoch: 8 cost time: 4.3474
2025-04-06 18:30:53,923 - INFO - Epoch: 8, Steps: 135 | Train Loss: 0.00017
Validation results --- Loss: 0.18244, Accuracy: 0.95521, Precision: 0.95889, Recall: 0.95521, F1: 0.95512, AUROC: 0.99564, AUPRC: 0.99498
Test results --- Loss: 0.15948, Accuracy: 0.94167, Precision: 0.94541, Recall: 0.94167, F1: 0.94154, AUROC: 0.99539, AUPRC: 0.99553
2025-04-06 18:30:53,923 - INFO - EarlyStopping counter: 5 out of 10
2025-04-06 18:30:53,924 - INFO - 
2025-04-06 18:30:53,924 - INFO - 
2025-04-06 18:30:57,137 - INFO - 	iters: 100, epoch: 9 | loss: 0.0000072
2025-04-06 18:30:57,139 - INFO - 	speed: 0.0518s/iter; left time: 638.4123s
2025-04-06 18:30:58,413 - INFO - Epoch: 9 cost time: 4.4889
2025-04-06 18:30:59,374 - INFO - Epoch: 9, Steps: 135 | Train Loss: 0.00011
Validation results --- Loss: 0.16537, Accuracy: 0.96146, Precision: 0.96422, Recall: 0.96146, F1: 0.96140, AUROC: 0.99575, AUPRC: 0.99506
Test results --- Loss: 0.14326, Accuracy: 0.94688, Precision: 0.94926, Recall: 0.94687, F1: 0.94680, AUROC: 0.99566, AUPRC: 0.99578
2025-04-06 18:30:59,375 - INFO - EarlyStopping counter: 6 out of 10
2025-04-06 18:30:59,375 - INFO - 
2025-04-06 18:30:59,375 - INFO - 
2025-04-06 18:31:03,236 - INFO - 	iters: 100, epoch: 10 | loss: 0.0001023
2025-04-06 18:31:03,237 - INFO - 	speed: 0.0610s/iter; left time: 743.1090s
2025-04-06 18:31:04,580 - INFO - Epoch: 10 cost time: 5.2047
2025-04-06 18:31:06,323 - INFO - Epoch: 10, Steps: 135 | Train Loss: 0.00007
Validation results --- Loss: 0.19212, Accuracy: 0.95312, Precision: 0.95714, Recall: 0.95312, F1: 0.95302, AUROC: 0.99590, AUPRC: 0.99529
Test results --- Loss: 0.16460, Accuracy: 0.94479, Precision: 0.94839, Recall: 0.94479, F1: 0.94468, AUROC: 0.99603, AUPRC: 0.99614
2025-04-06 18:31:06,323 - INFO - EarlyStopping counter: 7 out of 10
2025-04-06 18:31:06,340 - INFO - 
2025-04-06 18:31:06,340 - INFO - 
2025-04-06 18:31:10,070 - INFO - 	iters: 100, epoch: 11 | loss: 0.0000339
2025-04-06 18:31:10,070 - INFO - 	speed: 0.0683s/iter; left time: 823.4813s
2025-04-06 18:31:11,428 - INFO - Epoch: 11 cost time: 5.0875
2025-04-06 18:31:12,718 - INFO - Epoch: 11, Steps: 135 | Train Loss: 0.00006
Validation results --- Loss: 0.17928, Accuracy: 0.95937, Precision: 0.96243, Recall: 0.95937, F1: 0.95931, AUROC: 0.99592, AUPRC: 0.99532
Test results --- Loss: 0.15191, Accuracy: 0.94583, Precision: 0.94895, Recall: 0.94583, F1: 0.94574, AUROC: 0.99607, AUPRC: 0.99618
2025-04-06 18:31:12,718 - INFO - EarlyStopping counter: 8 out of 10
2025-04-06 18:31:12,718 - INFO - 
2025-04-06 18:31:12,718 - INFO - 
2025-04-06 18:31:16,572 - INFO - 	iters: 100, epoch: 12 | loss: 0.0000601
2025-04-06 18:31:16,572 - INFO - 	speed: 0.0650s/iter; left time: 774.7857s
2025-04-06 18:31:17,940 - INFO - Epoch: 12 cost time: 5.2215
2025-04-06 18:31:19,060 - INFO - Epoch: 12, Steps: 135 | Train Loss: 0.00005
Validation results --- Loss: 0.17600, Accuracy: 0.96250, Precision: 0.96512, Recall: 0.96250, F1: 0.96245, AUROC: 0.99596, AUPRC: 0.99535
Test results --- Loss: 0.14693, Accuracy: 0.94896, Precision: 0.95164, Recall: 0.94896, F1: 0.94888, AUROC: 0.99622, AUPRC: 0.99632
2025-04-06 18:31:19,060 - INFO - EarlyStopping counter: 9 out of 10
2025-04-06 18:31:19,060 - INFO - 
2025-04-06 18:31:19,060 - INFO - 
2025-04-06 18:31:22,309 - INFO - 	iters: 100, epoch: 13 | loss: 0.0000082
2025-04-06 18:31:22,310 - INFO - 	speed: 0.0574s/iter; left time: 675.9165s
2025-04-06 18:31:23,608 - INFO - Epoch: 13 cost time: 4.5478
2025-04-06 18:31:24,897 - INFO - Epoch: 13, Steps: 135 | Train Loss: 0.00004
Validation results --- Loss: 0.21504, Accuracy: 0.94479, Precision: 0.95028, Recall: 0.94479, F1: 0.94462, AUROC: 0.99603, AUPRC: 0.99547
Test results --- Loss: 0.18227, Accuracy: 0.94167, Precision: 0.94691, Recall: 0.94167, F1: 0.94150, AUROC: 0.99636, AUPRC: 0.99646
2025-04-06 18:31:24,898 - INFO - EarlyStopping counter: 10 out of 10
2025-04-06 18:31:24,898 - INFO - Early stopping triggered.
2025-04-06 18:31:24,899 - INFO - Early stopping
2025-04-06 18:31:24,923 - INFO - >>>>>>>testing : classification_TDBRAIN-Indep_-1_25_1_1.1_nolearnab_best_TCN_TDBRAIN_ftM_sl256_ll48_pl0_dm128_nh8_el6_dl1_df256_fc1_ebtimeF_dtTrue_Exp_seed45<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2025-04-06 18:31:27,452 - INFO - Validation results --- Loss: 0.13960, Accuracy: 0.96458, Precision: 0.96693, Recall: 0.96458, F1: 0.96454, AUROC: 0.99381, AUPRC: 0.99286
Test results --- Loss: 0.15817, Accuracy: 0.93333, Precision: 0.93370, Recall: 0.93333, F1: 0.93332, AUROC: 0.98666, AUPRC: 0.98721

